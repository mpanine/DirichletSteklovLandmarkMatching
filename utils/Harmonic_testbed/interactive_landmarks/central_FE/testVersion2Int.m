function out = testVersion2Int(l1,a,b,R)

out = @(t) (1/2).*a.*b.^(-1).*l1.*(a.*l1+(-1).*a.*R.*cos(t)+(b+(-1).*l1).*R.* ...
                  sin(t)).^(-4).*((-1).*a.^2.*l1.*R.^2.*((-1).*R+l1.*cos(t)).*((-3)+ ...
                  2.*log(R)).*((b+(-1).*l1).*cos(t)+a.*sin(t))+(-1).*a.^2.*l1.^2.* ...
                  sin(t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1).*(a.*l1+(-1).*a.* ...
                  R.*cos(t)+(b+(-1).*l1).*R.*sin(t)).^2+R.^2.*sin(t).*(a.*cos(t)+(( ...
                  -1).*b+l1).*sin(t)).*(a.*l1+(-1).*a.*R.*cos(t)+(b+(-1).*l1).*R.* ...
                  sin(t)).^2+2.*a.^2.*l1.*((-1).*R+l1.*cos(t)).*((b+(-1).*l1).*cos( ...
                  t)+a.*sin(t)).*(R.^2.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)) ...
                  .^(-1))+(1/2).*a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*(a.* ...
                  l1+(-4).*a.*R.*cos(t)+4.*(b+(-1).*l1).*R.*sin(t))));






% out = @(t) (1/16).*a.*b.^(-1).*(a.*l1+(-1).*a.*R.*cos(t)+(b+(-1).*l1).*R.* ...
% sin(t)).^(-4).*((-16).*a.^3.*b.*l1.^2.*R.^2+8.*a.^3.*l1.^3.*R.^2+ ...
%   6.*a.^3.*b.*R.^4+6.*a.*b.^3.*R.^4+(-3).*a.^3.*l1.*R.^4+(-15).*a.* ...
%   b.^2.*l1.*R.^4+12.*a.*b.*l1.^2.*R.^4+(-3).*a.*l1.^3.*R.^4+4.* ...
% a.^3.*b.*l1.*R.^3.*cos(3.*t)+4.*a.*b.^3.*l1.*R.^3.*cos(3.*t)+(-8) ...
%   .*a.^3.*l1.^2.*R.^3.*cos(3.*t)+(-8).*a.*b.^2.*l1.^2.*R.^3.*cos(3.* ...
%   t)+4.*a.*b.*l1.^3.*R.^3.*cos(3.*t)+(-2).*a.^3.*b.*R.^4.*cos(4.*t)+ ...
%   (-2).*a.*b.^3.*R.^4.*cos(4.*t)+3.*a.^3.*l1.*R.^4.*cos(4.*t)+3.*a.* ...
%   b.^2.*l1.*R.^4.*cos(4.*t)+(-1).*a.*l1.^3.*R.^4.*cos(4.*t)+16.* ...
%  a.^3.*b.*l1.^2.*R.^2.*log(R)+(-8).*a.^3.*l1.^3.*R.^2.*log(R)+4.* ...
%  a.*R.^2.*cos(2.*t).*((-1).*(b+(-1).*l1).^3.*R.^2+a.^2.*(4.*l1.^3+ ...
%   b.*R.^2)+(-2).*a.^2.*l1.^3.*log(R))+4.*a.*l1.*R.^3.*cos(t).*( ...
% a.^2.*(b+(-4).*l1)+(-7).*b.*(b+(-1).*l1).^2+(-4).*(b+(-1).*l1).*( ...
% a.^2+b.*((-1).*b+l1)).*log(R))+(-16).*a.^3.*b.*l1.^2.*R.^2.*log( ...
% a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1))+8.*a.^3.*l1.^3.* ...
% R.^2.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1))+28.* ...
% a.^4.*l1.*R.^3.*sin(t)+(-4).*a.^2.*b.^2.*l1.*R.^3.*sin(t)+(-8).* ...
% a.^2.*b.*l1.^2.*R.^3.*sin(t)+12.*a.^2.*l1.^3.*R.^3.*sin(t)+(-16).* ...
% a.^4.*l1.*R.^3.*log(R).*sin(t)+16.*a.^2.*b.^2.*l1.*R.^3.*log(R).* ...
% sin(t)+(-16).*a.^2.*b.*l1.^2.*R.^3.*log(R).*sin(t)+16.*a.^4.*l1.* ...
% R.^3.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1)).*sin(t)+( ...
% -16).*a.^2.*b.^2.*l1.*R.^3.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).* ...
% sin(t)).^(-1)).*sin(t)+16.*a.^2.*b.*l1.^2.*R.^3.*log(a.*l1.*(a.* ...
% cos(t)+((-1).*b+l1).*sin(t)).^(-1)).*sin(t)+(-16).*a.^5.*b.* ...
% l1.^4.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+8.*a.^5.*l1.^5.*(a.* ...
% cos(t)+((-1).*b+l1).*sin(t)).^(-2)+(-6).*a.^5.*b.*l1.^2.*R.^2.*( ...
% a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+(-6).*a.^3.*b.^3.*l1.^2.* ...
% R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+3.*a.^5.*l1.^3.* ...
% R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+15.*a.^3.*b.^2.* ...
% l1.^3.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+(-12).*a.^3.* ...
% b.*l1.^4.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+3.*a.^3.* ...
% l1.^5.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+(-4).*a.^5.* ...
% b.*l1.^3.*R.*cos(3.*t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+( ...
% -4).*a.^3.*b.^3.*l1.^3.*R.*cos(3.*t).*(a.*cos(t)+((-1).*b+l1).* ...
% sin(t)).^(-2)+8.*a.^5.*l1.^4.*R.*cos(3.*t).*(a.*cos(t)+((-1).*b+ ...
% l1).*sin(t)).^(-2)+8.*a.^3.*b.^2.*l1.^4.*R.*cos(3.*t).*(a.*cos(t)+ ...
% ((-1).*b+l1).*sin(t)).^(-2)+(-4).*a.^3.*b.*l1.^5.*R.*cos(3.*t).*( ...
% a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+2.*a.^5.*b.*l1.^2.*R.^2.* ...
% cos(4.*t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+2.*a.^3.*b.^3.* ...
% l1.^2.*R.^2.*cos(4.*t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+( ...
% -3).*a.^5.*l1.^3.*R.^2.*cos(4.*t).*(a.*cos(t)+((-1).*b+l1).*sin(t) ...
% ).^(-2)+(-3).*a.^3.*b.^2.*l1.^3.*R.^2.*cos(4.*t).*(a.*cos(t)+((-1) ...
% .*b+l1).*sin(t)).^(-2)+a.^3.*l1.^5.*R.^2.*cos(4.*t).*(a.*cos(t)+(( ...
% -1).*b+l1).*sin(t)).^(-2)+4.*a.^6.*l1.^3.*R.*sin(t).*(a.*cos(t)+(( ...
% -1).*b+l1).*sin(t)).^(-2)+(-28).*a.^4.*b.^2.*l1.^3.*R.*sin(t).*( ...
% a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+40.*a.^4.*b.*l1.^4.*R.*sin( ...
% t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+(-12).*a.^4.*l1.^5.*R.* ...
% sin(t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2)+32.*a.^4.*b.* ...
% l1.^3.*R.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1)+(-16).*a.^4.* ...
% l1.^4.*R.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1)+(-32).*a.^5.* ...
% l1.^2.*R.^2.*sin(t).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1)+32.* ...
% a.^3.*b.^2.*l1.^2.*R.^2.*sin(t).*(a.*cos(t)+((-1).*b+l1).*sin(t)) ...
% .^(-1)+(-32).*a.^3.*b.*l1.^3.*R.^2.*sin(t).*(a.*cos(t)+((-1).*b+ ...
% l1).*sin(t)).^(-1)+(-4).*a.^3.*l1.^2.*R.*cos(2.*t).*((-2).*l1.*R.* ...
% log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1))+((a.^2.*b+(-1) ...
% .*(b+(-1).*l1).^3).*R+4.*a.^2.*l1.^2.*cos(t)+(-4).*a.*(b+(-1).*l1) ...
% .*l1.^2.*sin(t)).*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2))+(-4).* ...
% a.*l1.*R.*cos(t).*((-4).*(b+(-1).*l1).*(a.^2+b.*((-1).*b+l1)).* ...
% R.^2.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1))+a.*l1.*( ...
% a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*(a.*l1.*(b.*(b+(-1).*l1) ...
% .^2+a.^2.*((-7).*b+4.*l1))+8.*a.*(b+(-1).*l1).*(a.^2+b.*((-1).*b+ ...
% l1)).*R.*cos(t)+(-8).*(b+(-1).*l1).^2.*(a.^2+b.*((-1).*b+l1)).*R.* ...
% sin(t)))+(-16).*a.^4.*l1.^2.*R.^2.*sin(2.*t)+(-16).*a.^2.*b.^2.* ...
% l1.^2.*R.^2.*sin(2.*t)+16.*a.^2.*b.*l1.^3.*R.^2.*sin(2.*t)+(-2).* ...
% a.^4.*R.^4.*sin(2.*t)+(-12).*a.^2.*b.^2.*R.^4.*sin(2.*t)+(-2).* ...
% b.^4.*R.^4.*sin(2.*t)+18.*a.^2.*b.*l1.*R.^4.*sin(2.*t)+6.*b.^3.* ...
% l1.*R.^4.*sin(2.*t)+(-6).*a.^2.*l1.^2.*R.^4.*sin(2.*t)+(-6).* ...
% b.^2.*l1.^2.*R.^4.*sin(2.*t)+2.*b.*l1.^3.*R.^4.*sin(2.*t)+8.* ...
% a.^4.*l1.^2.*R.^2.*log(R).*sin(2.*t)+8.*a.^2.*b.^2.*l1.^2.*R.^2.* ...
% log(R).*sin(2.*t)+(-8).*a.^2.*b.*l1.^3.*R.^2.*log(R).*sin(2.*t)+( ...
% -8).*a.^4.*l1.^2.*R.^2.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t) ...
% ).^(-1)).*sin(2.*t)+(-8).*a.^2.*b.^2.*l1.^2.*R.^2.*log(a.*l1.*(a.* ...
% cos(t)+((-1).*b+l1).*sin(t)).^(-1)).*sin(2.*t)+8.*a.^2.*b.*l1.^3.* ...
% R.^2.*log(a.*l1.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1)).*sin(2.* ...
% t)+2.*a.^6.*l1.^2.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).* ...
% sin(2.*t)+12.*a.^4.*b.^2.*l1.^2.*R.^2.*(a.*cos(t)+((-1).*b+l1).* ...
% sin(t)).^(-2).*sin(2.*t)+2.*a.^2.*b.^4.*l1.^2.*R.^2.*(a.*cos(t)+(( ...
% -1).*b+l1).*sin(t)).^(-2).*sin(2.*t)+(-18).*a.^4.*b.*l1.^3.*R.^2.* ...
% (a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*sin(2.*t)+(-6).*a.^2.* ...
% b.^3.*l1.^3.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*sin(2.* ...
% t)+6.*a.^4.*l1.^4.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).* ...
% sin(2.*t)+6.*a.^2.*b.^2.*l1.^4.*R.^2.*(a.*cos(t)+((-1).*b+l1).* ...
% sin(t)).^(-2).*sin(2.*t)+(-2).*a.^2.*b.*l1.^5.*R.^2.*(a.*cos(t)+(( ...
% -1).*b+l1).*sin(t)).^(-2).*sin(2.*t)+16.*a.^5.*l1.^3.*R.*(a.*cos( ...
% t)+((-1).*b+l1).*sin(t)).^(-1).*sin(2.*t)+16.*a.^3.*b.^2.*l1.^3.* ...
% R.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1).*sin(2.*t)+(-16).*a.^3.* ...
% b.*l1.^4.*R.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-1).*sin(2.*t)+4.* ...
% a.^4.*l1.*R.^3.*sin(3.*t)+4.*a.^2.*b.^2.*l1.*R.^3.*sin(3.*t)+(-4) ...
% .*a.^2.*l1.^3.*R.^3.*sin(3.*t)+(-4).*a.^6.*l1.^3.*R.*(a.*cos(t)+(( ...
% -1).*b+l1).*sin(t)).^(-2).*sin(3.*t)+(-4).*a.^4.*b.^2.*l1.^3.*R.*( ...
% a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*sin(3.*t)+4.*a.^4.*l1.^5.* ...
% R.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*sin(3.*t)+(-1).*a.^4.* ...
% R.^4.*sin(4.*t)+b.^4.*R.^4.*sin(4.*t)+(-3).*a.^2.*b.*l1.*R.^4.* ...
% sin(4.*t)+(-3).*b.^3.*l1.*R.^4.*sin(4.*t)+3.*a.^2.*l1.^2.*R.^4.* ...
% sin(4.*t)+3.*b.^2.*l1.^2.*R.^4.*sin(4.*t)+(-1).*b.*l1.^3.*R.^4.* ...
% sin(4.*t)+a.^6.*l1.^2.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^( ...
% -2).*sin(4.*t)+(-1).*a.^2.*b.^4.*l1.^2.*R.^2.*(a.*cos(t)+((-1).*b+ ...
% l1).*sin(t)).^(-2).*sin(4.*t)+3.*a.^4.*b.*l1.^3.*R.^2.*(a.*cos(t)+ ...
%  ((-1).*b+l1).*sin(t)).^(-2).*sin(4.*t)+3.*a.^2.*b.^3.*l1.^3.* ...
% R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*sin(4.*t)+(-3).* ...
% a.^4.*l1.^4.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)).^(-2).*sin(4.* ...
% t)+(-3).*a.^2.*b.^2.*l1.^4.*R.^2.*(a.*cos(t)+((-1).*b+l1).*sin(t)) ...
% .^(-2).*sin(4.*t)+a.^2.*b.*l1.^5.*R.^2.*(a.*cos(t)+((-1).*b+l1).* ...
% sin(t)).^(-2).*sin(4.*t)); 




end